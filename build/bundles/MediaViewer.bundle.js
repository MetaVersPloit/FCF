(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{1879:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return g.default.createElement(w.DynamicModuleLoader,{strictMode:!0,modules:[i.ContactSuggestionsModule]},g.default.createElement(z,e))},t.ForwardItemStatus=void 0;var n=I(a(27)),r=a(8),l=I(a(5)),o=I(a(340)),u=a(1893),i=a(1886),d=a(1892),s=I(a(1)),c=a(1888),f=I(a(50)),m=a(21),h=a(23),p=a(11),g=_(a(0)),w=a(138),y=I(a(2)),b=_(a(22)),M=I(a(1918)),v=a(350),x=I(a(242)),E=I(a(13)),C=a(6),S=I(a(4));function O(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return O=function(){return e},e}function _(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=O();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}return a.default=e,t&&t.set(e,a),a}function I(e){return e&&e.__esModule?e:{default:e}}const k=(0,s.default)(y.default)(e=>({borderRadius:4,pointerEvents:"auto",flex:"1 1 0px"})),P=(0,s.default)(y.default)({justifyContent:"center",flexDirection:"row",alignItems:"center",margin:"12px 12px 4px 12px"}),j={includeGroups:!0,includePages:!1,includeIntegratedMessageSearchResults:!1,includeSecureThreads:!1},D=(0,s.default)(y.default)({alignItems:"center",flex:1,paddingLeft:25});let R;t.ForwardItemStatus=R,function(e){e[e.UNCLICKED=0]="UNCLICKED",e[e.CLICKED=1]="CLICKED",e[e.SENDING=2]="SENDING"}(R||(t.ForwardItemStatus=R={}));const A={searchQueryChanged:h.InboxActions.search.searchQueryChanged,sendAttachmentForward:h.InboxActions.messages.sendAttachmentForward,sendMessageForward:h.InboxActions.messages.sendMessageForward,sendMessage:h.InboxActions.messages.sendMessage},z=(0,p.connect)((function(){const e=(0,d.getForwardViewSuggestionsSelector)();return t=>{const a=(0,h.getSearchInfo)(t,r.SearchSource.ThreadDetails),n=e(t);return{userId:(0,m.requireAuthenticationData)(t).userID,searchResults:a.searchResults,searchInfo:a,suggestions:n}}}),A)((function(e){const{attachment:t,message:a,onModalClear:i,elementRef:d,className:s,userId:m,searchResults:h,searchInfo:p,suggestions:w={},searchQueryChanged:y,sendAttachmentForward:O,sendMessageForward:_,sendMessage:I}=e,A=(0,C.useTheme)(),[z,T]=(0,g.useState)(""),[V,N]=(0,g.useState)({}),[F,B]=(0,g.useState)({}),K=(0,o.default)(z,200);(0,g.useEffect)(()=>{null!=K&&y(K,j,r.SearchSource.ThreadDetails)},[y,K]);const L=e=>{B(t=>({...t,[e]:R.CLICKED})),window.setTimeout(()=>{B(t=>({...t,[e]:R.SENDING}))},1500)},W=(0,g.useCallback)(e=>t?void(t&&t.attachmentFbid&&(O({threadKey:e.resultId,attachmentId:t.attachmentFbid}),L(e.resultId))):void(a&&a.message.threadKey&&a.message.timestampMs&&a.message.messageId&&(a.message.stickerId&&a.attachments&&a.attachments[0]&&a.attachments[0].attachmentType===r.AttachmentType.Sticker?(0,v.isHotlike)(a.message.stickerId)?O({threadKey:e.resultId,attachmentId:a.attachments[0].attachmentFbid}):I({senderId:m,threadKey:e.resultId,stickerId:a.message.stickerId,previewUrl:(0,n.default)(a.attachments[0].previewUrlInfo),previewUrlMimeType:a.attachments[0].previewUrlMimeType}):_({threadKey:e.resultId,forwardedMsgId:a.message.messageId,forwardedMsgThreadKey:a.message.threadKey,forwardedMsgTimestampMs:a.message.timestampMs}),L(e.resultId))),[a,t,m,O,_,I]);if((0,g.useEffect)(()=>{const e=h&&h.map(({profilePicture:e,secondaryProfilePicture:t,title:a,resultId:n})=>({picture:e,secondaryPicture:t,displayName:a,resultId:n}));N({[u.ThreadCategory.Results]:e||[]})},[h]),!t&&!a)return null;const{isLoadingMoreSearchResults:G,hasNoSearchResults:U}=(0,c.getSearchStatus)(p,z);return(g.default.createElement(E.default,{name:"forwardView"},g.default.createElement(k,{className:s,ref:d,onMouseDown:e=>e.stopPropagation()},g.default.createElement(P,null,g.default.createElement(D,null,g.default.createElement(S.default,{use:"body-semibold"},l.default._("Forward",null,{hk:"1FXuRK"}))),i&&g.default.createElement(b.default,{icon:f.default,size:b.RoundButtonSize.Small,"aria-label":l.default._("Close Dialog",null,{hk:"3zP7Cd"}).toString(),buttonColor:A.colors.base40,telemetryName:"forwarding_modal_close_button",onClick:i})),g.default.createElement(x.default,{query:z,onQueryChange:T,autoFocus:!0}),g.default.createElement(M.default,{threadCategories:z&&V?V:w,onClick:W,isLoadingMoreSearchResults:G,hasNoSearchResults:U,forwardingStatus:F,setForwardingStatus:B}))))}))},1918:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({threadCategories:e,isLoadingMoreSearchResults:t,hasNoSearchResults:a,forwardingStatus:u,setForwardingStatus:d,onClick:f}){return s.default.createElement(m.default,null,s.default.createElement(w,null,e&&Object.keys(e).map(m=>{const p=e[m];return(s.default.createElement(s.default.Fragment,{key:m},s.default.createElement(c.default,{css:{paddingLeft:12}},s.default.createElement(h.default,{title:y[m]})),p&&p.length>0&&p.map(e=>e.resultId?s.default.createElement(r.default,{key:e.resultId,pictureUrl:(0,o.default)(e.picture),secondaryPictureUrl:(0,o.default)(e.secondaryPicture),displayName:e.displayName,threadKey:e.resultId,onClick:()=>f(e),forwardingStatus:u[e.resultId]?u[e.resultId]:l.ForwardItemStatus.UNCLICKED,setForwardingStatus:d}):s.default.createElement(c.default,{css:{paddingLeft:12}},s.default.createElement(h.default,{title:e.displayName}))),t&&s.default.createElement(n.default,{size:n.SpinnerSize.Small,delay:300,css:{marginTop:24,marginBottom:6}}),a&&s.default.createElement(i.NoResultsFound,null)))})))};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=g();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(82)),r=p(a(1919)),l=a(1879),o=p(a(27)),u=p(a(5)),i=a(1887),d=p(a(1)),s=p(a(0)),c=p(a(2)),f=p(a(33)),m=p(a(45)),h=p(a(186));function p(e){return e&&e.__esModule?e:{default:e}}function g(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return g=function(){return e},e}const w=(0,d.default)(f.default)({paddingRight:12,paddingBottom:8}),y={recents:u.default._("Recents",null,{hk:"33oZDt"}).toString(),top_groups:u.default._("Top Groups",null,{hk:"39KDMn"}).toString(),connections:u.default._("Connections",null,{hk:"Q1OBY"}).toString(),results:u.default._("Results",null,{hk:"2oNg3Q"}).toString()}},1919:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=C(a(345)),r=a(1879),l=a(8),o=C(a(5)),u=C(a(245)),i=C(a(1)),d=a(1920),s=C(a(598)),c=C(a(1921)),f=C(a(251)),m=a(21),h=a(23),p=a(11),g=E(a(0)),w=C(a(2)),y=E(a(22)),b=E(a(82)),M=a(6),v=C(a(4));function x(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return x=function(){return e},e}function E(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=x();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}return a.default=e,t&&t.set(e,a),a}function C(e){return e&&e.__esModule?e:{default:e}}const S=(0,i.default)(w.default)({height:50,flexDirection:"row",width:"100%",alignItems:"center",paddingLeft:"12px"}),O=(0,i.default)(w.default)({flex:1,marginTop:0,marginBottom:0,marginLeft:15,justifyContent:"center"}),_=(0,i.default)(w.default)({height:32,width:32,justifyContent:"center",alignItems:"center"});const I={sendAttachmentForward:h.InboxActions.messages.sendAttachmentForward};var k=(0,p.connect)((function(e,t){return{userID:(0,m.requireAuthenticationData)(e).userID,participants:(0,h.getParticipantListForThread)(e,t.threadKey),presence:(0,h.getThreadPresences)(e,t.threadKey),lastMessageInfo:(0,h.getLastMessageInfoForThread)(e,t)}}),I)((function(e){const{pictureUrl:t,secondaryPictureUrl:a,displayName:i,threadKey:m,onClick:h,forwardingStatus:p,setForwardingStatus:w,userID:x,participants:E,presence:C,lastMessageInfo:I}=e,k=(0,u.default)(C);(0,g.useEffect)(()=>{I&&1===I.status&&p===r.ForwardItemStatus.CLICKED&&w(e=>({...e,[m]:r.ForwardItemStatus.SENDING}))},[I,w,p,m]);const P=(0,M.useTheme)(),j=E.filter(e=>e.contactId!=x);let D;switch(p){case r.ForwardItemStatus.CLICKED:D=g.default.createElement(b.default,{size:b.SpinnerSize.Small});break;case r.ForwardItemStatus.SENDING:switch(I&&I.status){case l.MessageSendStatus.ServerReceived:case l.MessageSendStatus.SentOnly:D=g.default.createElement(c.default,{size:16,color:P.colors.base50});break;case l.MessageSendStatus.RetriableError:case l.MessageSendStatus.NonRetriableError:D=g.default.createElement(f.default,{size:16,color:P.colors.red});break;default:D=g.default.createElement(b.default,{size:b.SpinnerSize.Small})}break;default:D=g.default.createElement(y.default,{"aria-label":o.default._("Forward to{participant_name}",[o.default._param("participant_name",i)],{hk:"1s790p"}).toString(),telemetryName:"forward_attachment_button",icon:s.default,use:y.RoundButtonUse.Transparent,onClick:h})}return(g.default.createElement(S,{role:"link"},g.default.createElement(n.default,{profilePictureUrl:t,secondaryPictureUrl:a,participants:E,viewerId:x,presence:k}),g.default.createElement(O,null,g.default.createElement(v.default,{use:"body-semibold"},i),E.length>2&&g.default.createElement(v.default,{use:"caption",color:P.colors.flatBase70},(0,d.displayParticipantNames)(j))),g.default.createElement(_,null,D)))}));t.default=k},1921:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 16 16",height:e.height?e.height:e.size,width:e.width?e.width:e.size,color:e.color},r.default.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 16A8 8 0 108 0a8 8 0 000 16zm3.774-10.407a1 1 0 00-1.73-1.004L7.417 9.114a.15.15 0 01-.236.031L5.798 7.762a1 1 0 00-1.414 1.414l2.44 2.44a1 1 0 001.572-.205l3.378-5.818z",clipRule:"evenodd"}))};var n,r=(n=a(0))&&n.__esModule?n:{default:n}},1922:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useGalleryContext=function(){return(0,n.useContext)(l)},t.GalleryContextProvider=function(e){const{onActivate:t,onContextMenu:a,latestRowRendered:r,threadKey:o}=e,u=(0,n.useMemo)(()=>({onActivate:t,onContextMenu:a,latestRowRendered:r,threadKey:o}),[t,a,r,o]);return n.default.createElement(l.Provider,{value:u},e.children)};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if(Object.prototype.hasOwnProperty.call(e,l)){var o=n?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(a,l,o):a[l]=e[l]}a.default=e,t&&t.set(e,a);return a}(a(0));function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}const l=(0,n.createContext)({onActivate:()=>{},onContextMenu:()=>{},latestRowRendered:{current:-1},threadKey:""})},2133:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(58),r=c(a(2134)),l=a(241),o=c(a(2146)),u=c(a(5)),i=a(23),d=a(11),s=c(a(0));function c(e){return e&&e.__esModule?e:{default:e}}const f={closeMediaViewer:i.InboxActions.mediaViewer.closeMediaViewer};var m=(0,d.connect)((function(e,t){const a=(0,i.getMediaViewerInfo)(e,t.threadKey);if(!a)throw new Error("MediaViewer was rendered, but no mediaViewerInfo was found in state");return{mediaViewerInfo:a}}),f)((function(e){const{mediaViewerInfo:t,threadKey:a,closeMediaViewer:i}=e;return a?s.default.createElement(n.Modal,{modalType:"fullscreen",onHideModal:()=>i(a),"aria-label":t.isGallery?u.default._("Gallery View",null,{hk:"3f8YUj"}).toString():u.default._("Media View",null,{hk:"4qbf28"}).toString()},s.default.createElement(l.OuterContainer,null,t.isGallery?s.default.createElement(o.default,{threadKey:a}):s.default.createElement(r.default,{threadKey:a}))):null}));t.default=m},2134:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=X(a(16)),r=a(66),l=Z(a(250)),o=Z(a(188)),u=a(599),i=Z(a(2135)),d=Z(a(2137)),s=Z(a(2138)),c=Z(a(2139)),f=a(241),m=Z(a(2140)),h=a(117),p=Z(a(27)),g=a(8),w=Z(a(5)),y=Z(a(9)),b=a(84),M=Z(a(143)),v=X(a(2142)),x=a(28),E=a(364),C=a(23),S=Z(a(1)),O=Z(a(2143)),_=Z(a(193)),I=Z(a(161)),k=Z(a(50)),P=Z(a(631)),j=Z(a(600)),D=Z(a(363)),R=Z(a(257)),A=Z(a(2144)),z=Z(a(2145)),T=a(21),V=a(139),N=a(11),F=X(a(0)),B=Z(a(2)),K=X(a(22)),L=Z(a(1879)),W=a(82),G=Z(a(91)),U=a(6),H=Z(a(4));function Z(e){return e&&e.__esModule?e:{default:e}}function q(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return q=function(){return e},e}function X(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=q();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}return a.default=e,t&&t.set(e,a),a}const $=(0,S.default)(B.default)({flex:1,justifyContent:"flex-end",alignItems:"center",flexDirection:"row",marginRight:8}),Y=(0,S.default)(B.default)({flex:1,justifyContent:"flex-start",alignItems:"center",flexDirection:"row",marginLeft:8}),J=(0,S.default)(B.default)({flex:1,justifyContent:"center",alignItems:"center",flexDirection:"row"}),Q=(0,S.default)(K.default)({margin:1}),ee=(0,S.default)(B.default)({height:"100%",width:48,alignItems:"center",justifyContent:"center"}),te=(0,S.default)(B.default)({alignItems:"center",height:"100%",justifyContent:"center",width:"100%",overflow:"hidden","img, video":{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}),ae=(0,S.default)(B.default)(e=>({alignItems:"center",backgroundColor:e.theme.colors.base10,height:"100px",justifyContent:"center",width:"350px"})),ne=(0,S.default)(d.default)(e=>({height:"inherit",width:"inherit",justifyContent:"center",alignItems:"center",willChange:"transform",transform:`translate3d(${e.translate.x}px, ${e.translate.y}px, 0px) scale(${e.zoom})`,cursor:`${e.cursor}`,".messenger-media-viewer-content":{transform:"translateZ(0px)"}})),re=(0,S.default)(G.default)(e=>({boxShadow:"0 2px 14px 0 rgba(0, 0, 0, 0.12), 0 0 1px 0 rgba(0, 0, 0, 0.10)",borderRadius:e.theme.select({mac:4,windows:0})})),le=(0,S.default)(o.default)(e=>({width:400,height:450,backgroundColor:e.theme.select({dark:e.theme.colors.flatBase50,light:e.theme.colors.base10})})),oe=(0,S.default)(G.default)({boxShadow:"0 2px 14px 0 rgba(0, 0, 0, 0.12), 0 0 1px 0 rgba(0, 0, 0, 0.10)"});function ue(e,t){return e[0]===t}function ie(e,t){return e[e.length-1]===t}const de={showModal:x.AppContextActions.showModal,downloadContent:C.InboxActions.messages.downloadContent,closeMediaViewer:C.InboxActions.mediaViewer.closeMediaViewer,openMediaGallery:C.InboxActions.mediaViewer.openMediaGallery,openPrevAttachment:C.InboxActions.mediaViewer.openPrevAttachment,openNextAttachment:C.InboxActions.mediaViewer.openNextAttachment,sendMessageWithAttachment:C.InboxActions.messages.sendMessageWithAttachment,openAttachmentIndex:C.InboxActions.mediaViewer.openAttachmentIndex,loadMoreAttachments:C.InboxActions.mediaViewer.loadMoreAttachments};var se=(0,N.connect)((function(e,{threadKey:t}){const a=(0,C.getMediaViewerInfo)(e,t);if(!a)throw new Error("GalleryView was opened, but no mediaViewerInfo was found in the state");const{attachmentIndex:n}=a,r=(0,C.getThreadMedia)(e,t),l=null!=n?r[n]:null;return{userID:(0,T.requireAuthenticationData)(e).userID,orderedAttachments:r,attachment:l,attachmentIndex:n,videoInfo:(0,E.getVideoInfo)(e,t,l),showDownloadDialog:(0,V.isGatekeeperEnabled)(e,"worchon_show_download_dialog")}}),de)((function(e){const{threadKey:t,orderedAttachments:a,attachment:o,showModal:d,openMediaGallery:x,closeMediaViewer:E,attachmentIndex:C,downloadContent:S,openPrevAttachment:T,openNextAttachment:V,openAttachmentIndex:N,loadMoreAttachments:B,videoInfo:G,showDownloadDialog:Z}=e,q=(0,U.useTheme)(),{showContextMenu:X}=(0,r.useContextMenu)(),{translate:de,zoom:se,zoomIn:ce,zoomOut:fe,zoomToOriginalSize:me,handleMouseDown:he,handleMouseWheel:pe,cursor:ge}=(0,v.default)(),{imgRef:we,videoRef:ye,getDimensions:be}=function(){const e=(0,F.useRef)(null),t=(0,F.useRef)(null);return{imgRef:e,videoRef:t,getDimensions:()=>e.current?`${e.current.naturalWidth}x${e.current.naturalHeight}`:t.current?`${t.current.videoWidth}x${t.current.videoHeight}`:null}}(),Me=(0,F.useRef)(null),ve=(0,F.useRef)(null),[xe,Ee]=(0,M.default)(ve,Me);(0,F.useEffect)(()=>{Ee(!1),me()},[o,Ee,me]);const Ce=(0,F.useRef)(),[Se,Oe]=(0,F.useState)(!1);(0,F.useEffect)(()=>(Se||(Ce.current=window.setTimeout(()=>{Oe(!0)},200)),()=>{Ce.current&&clearTimeout(Ce.current)}),[Se]);const _e=(0,F.useCallback)((0,h.throttle)(()=>{T(t)},150),[t]),Ie=(0,F.useCallback)((0,h.throttle)(()=>{V(t)},150),[t]),[ke,Pe]=(0,F.useState)(!1),je=(0,F.useRef)(null);(0,F.useEffect)(()=>y.default.window.addTouchScrollStartListener(()=>{Pe(!0)}),[]),(0,F.useEffect)(()=>{null!==je.current&&(je.current>30?_e():je.current<-30&&Ie(),je.current=null)},[ke,_e,Ie]),(0,F.useEffect)(()=>y.default.window.addTouchScrollEndListener(()=>{Pe(!1)}),[]);const De=(0,F.useRef)(null),Re=(0,F.useRef)(null),[Ae,ze]=(0,M.default)(De,Re),Te=(0,F.useCallback)(e=>{"Escape"===e.key&&(ze(!1),e.stopPropagation())},[ze]);(0,b.useShortcut)("left",()=>Ie()),(0,b.useShortcut)("right",()=>_e());const Ve=o?o.attachmentType:null,Ne=Ve===g.AttachmentType.Video,Fe=(0,F.useCallback)(e=>{o&&X({items:(0,u.getMediaContextMenu)(o,S,d,Z),target:e})},[o,S,d,X,Z]),Be=a.length;(0,F.useEffect)(()=>{null!=C&&C>=Be-3&&B(t,g.AttachmentMediaGroup.PhotosAndVideos)},[C,Be,t,B]);const Ke=w.default._("Zoom Out",null,{hk:"1HatPZ"}).toString(),Le=w.default._("Original Size",null,{hk:"3PV5Al"}).toString(),We=w.default._("Zoom In",null,{hk:"2FlZiy"}).toString(),Ge=w.default._("Info",null,{hk:"3FbT4v"}).toString(),Ue=w.default._("Download",null,{hk:"1rMXXG"}).toString(),He=w.default._("Forward",null,{hk:"1XgLHH"}).toString(),Ze=w.default._("Close",null,{hk:"2uk4iF"}).toString(),qe=w.default._("Older",null,{hk:"ckg15"}).toString(),Xe=w.default._("Newer",null,{hk:"2LbzPM"}).toString();return F.default.createElement(l.default,{listenToGlobalErrors:!1,component:"media-view",fallback:(e,a)=>F.default.createElement(c.default,{onClose:()=>E(t)})},F.default.createElement(f.ControlsContainer,{height:48},F.default.createElement(Y,null,F.default.createElement(n.default,{telemetryName:"toMediaGallery","aria-label":w.default._("Go to media gallery",null,{hk:"2sAtQ9"}).toString(),caption:w.default._("View Gallery",null,{hk:"2PBZc5"}).toString(),size:n.RectangleButtonSize.Small,icon:R.default,onClick:()=>x(t,C),buttonColor:q.colors.base30})),F.default.createElement(J,null,F.default.createElement(Q,{telemetryName:"mediaZoomOut","aria-label":Ke,title:Ke,size:K.RoundButtonSize.Small,icon:z.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,onClick:fe,disabled:se<v.MIN_ZOOM||Ne}),F.default.createElement(Q,{telemetryName:"originalImageSize","aria-label":Le,title:Le,size:K.RoundButtonSize.Small,icon:O.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,disabled:(0,v.equalToOne)(se)||Ne,onClick:me}),F.default.createElement(Q,{telemetryName:"mediaZoomIn","aria-label":We,title:We,size:K.RoundButtonSize.Small,icon:A.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,onClick:ce,disabled:se>v.MAX_ZOOM||Ne})),F.default.createElement($,null,F.default.createElement(f.MediaViewerButtons,{ref:ve,telemetryName:"mediaViewerInfo","aria-label":Ge,title:Ge,size:K.RoundButtonSize.Small,icon:D.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,onClick:()=>{Ee(!xe)},disabled:null==o}),xe&&o&&F.default.createElement(oe,{target:ve.current,placement:"bottom",showArrow:!0,arrowStyle:{backgroundColor:q.select({dark:q.colors.flatBase50,light:q.colors.base10})},arrowSize:15,modifiers:{offset:{enabled:!0,offset:"0 16"}},ref:Me},F.default.createElement(i.default,{threadKey:t,attachment:o,dimensions:be(),onDismiss:()=>Ee(!1)})),F.default.createElement(f.MediaViewerButtons,{telemetryName:"downloadMediaView","aria-label":Ue,title:Ue,size:K.RoundButtonSize.Small,icon:P.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,onClick:()=>{o&&S((0,p.default)(o.playableUrlInfo))}}),o&&F.default.createElement(F.default.Fragment,null,F.default.createElement(f.MediaViewerButtons,{ref:De,telemetryName:"forwardMedia","aria-label":He,title:He,size:K.RoundButtonSize.Small,icon:j.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,onClick:()=>{ze(!Ae)},disabled:Boolean(!(o&&o.attachmentFbid))}),Ae&&F.default.createElement(re,{target:De.current,showArrow:!0,arrowStyle:{backgroundColor:q.select({dark:q.colors.flatBase50,light:q.colors.base10})},modifiers:{offset:{enabled:!0,offset:"0 16"}},arrowSize:15,placement:"bottom"},F.default.createElement(le,{onKeyDown:Te},F.default.createElement(L.default,{elementRef:Re,attachment:o})))),F.default.createElement(f.MediaViewerButtons,{telemetryName:"closeMediaView","aria-label":Ze,title:Ze,size:K.RoundButtonSize.Small,icon:k.default,buttonColor:q.colors.base30,iconColor:q.semanticColors.textPrimary,onClick:()=>E(t)}))),F.default.createElement(f.ContentContainer,null,F.default.createElement(ee,null,F.default.createElement(K.default,{telemetryName:"newerMediaView","aria-label":Xe,title:Xe,size:K.RoundButtonSize.Small,icon:_.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,disabled:ue(a,o),onClick:()=>V(t)})),F.default.createElement(te,{onMouseDown:he,onWheel:e=>{pe(e),ke&&(je.current=e.deltaX)}},(()=>{if(!o)return null;switch(Ve){case g.AttachmentType.Image:const e=(0,p.default)(o.playableUrlInfo)||(0,p.default)(o.previewUrlInfo);return(F.default.createElement(ne,{key:o.offlineAttachmentId||o.attachmentFbid,src:e,spinnerSize:W.SpinnerSize.Large,telemetryName:"mediaViewerImage",onActivate:e=>e.stopPropagation(),zoom:se,cursor:1===se?"initial":ge,translate:de,ref:we,onContextMenu:Fe}));case g.AttachmentType.Video:return F.default.createElement(s.default,{key:o.offlineAttachmentId||o.attachmentFbid,attachment:o,videoInfo:G,threadKey:t,telemetryName:"mediaViewerVideo",onContextMenu:Fe,ref:ye});default:return F.default.createElement(ae,null,F.default.createElement(H.default,{use:"title"},w.default._("Unsupported media format",null,{hk:"2x9ogJ"})))}})()),F.default.createElement(ee,null,F.default.createElement(K.default,{telemetryName:"olderMediaView","aria-label":qe,title:qe,size:K.RoundButtonSize.Small,icon:I.default,use:K.RoundButtonUse.Transparent,iconColor:q.semanticColors.textPrimary,disabled:ie(a,o),onClick:()=>T(t)}))),F.default.createElement(m.default,{orderedAttachments:a,selectedIndex:C||0,onOpenAttachment:e=>N(t,e)}))}));t.default=se},2135:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({attachment:e,onDismiss:t,dimensions:a}){const n=(0,s.useTheme)(),l=(0,i.useMemo)(()=>(0,u.computeMessageListTimestamp)(e.timestampMs),[e.timestampMs]),d=(0,o.formatBytes)(parseInt(e.filesize,10)),f=r.default._("Uploaded at {photo/video upload timestamp}. File size: {file size}",[r.default._param("photo/video upload timestamp",l),r.default._param("file size",d)],{hk:"3pYlk8"}),m=(0,i.useCallback)(e=>{"Escape"===e.key&&(e.stopPropagation(),t())},[t]);return i.default.createElement(p,null,i.default.createElement(g,{onActivate:null,"aria-label":f.toString(),onKeyDown:m,role:"dialog"},i.default.createElement(w,null,i.default.createElement(c.default,{use:"subtext-medium"},r.default._("Info",null,{hk:"qH5Mq"}))),i.default.createElement(y,null,i.default.createElement(b,null,i.default.createElement(M,{wrapText:!0,use:"caption",color:n.colors.base70},r.default._("Uploaded at {photo/video upload timestamp}",[r.default._param("photo/video upload timestamp",l)],{hk:"Jlpg7"})),"0"!=e.filesize&&i.default.createElement(M,{use:"caption",color:n.colors.base70},(0,o.formatBytes)(parseInt(e.filesize,10)).toString()),a&&i.default.createElement(M,{use:"caption",color:n.colors.base70},a)))))};var n=h(a(188)),r=h(a(5)),l=h(a(1)),o=a(2136),u=a(115),i=m(a(0)),d=m(a(2)),s=a(6),c=h(a(4));function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function m(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}return a.default=e,t&&t.set(e,a),a}function h(e){return e&&e.__esModule?e:{default:e}}const p=(0,l.default)(n.default)(e=>({backgroundColor:e.theme.select({dark:e.theme.colors.flatBase50,light:e.theme.colors.base10}),minWidth:220,maxWidth:255,pointerEvents:"auto"})),g=(0,l.default)(d.FocusableView)({flex:1}),w=(0,l.default)(d.default)({height:20,justifyContent:"center",flexDirection:"row",alignItems:"center",marginTop:4,marginBottom:9}),y=(0,l.default)(d.default)({flexDirection:"row",margin:"0px 12px 12px 12px",overflow:"hidden"}),b=(0,l.default)(d.default)({marginLeft:12,maxWidth:188,display:"flex",flexDirection:"column",justifyContent:"space-between"}),M=(0,l.default)(c.default)({paddingBottom:3})},2136:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatBytes=function(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1e3));return parseFloat((e/Math.pow(1e3,t)).toLocaleString(document.documentElement.lang,{minimumFractionDigits:2,maximumFractionDigits:2}))+" "+["Bytes","KB","MB","GB","TB"][t]}},2137:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c(a(1903)),r=c(a(189)),l=c(a(1)),o=c(a(169)),u=c(a(0)),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(2)),d=c(a(82));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function c(e){return e&&e.__esModule?e:{default:e}}function f(){return(f=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const m=(0,l.default)(i.default)({top:0,height:"100%",width:"100%",justifyContent:"center",alignItems:"center",position:"absolute"}),h=u.default.forwardRef((function({disabled:e,telemetryName:t,onActivate:a,onContextMenu:n,src:l,className:d,showPlayIcon:s},c){const f=(0,r.default)({url:l,mediaType:"image"});return f?u.default.createElement(i.FocusableView,{telemetryName:t,onActivate:a,disabled:e,onContextMenu:n,className:d},u.default.createElement("img",{className:"messenger-media-viewer-content",src:f}),s&&u.default.createElement(m,null,u.default.createElement(o.default,{size:12,color:"white"}))):null}));var p=u.default.memo(u.default.forwardRef((function(e,t){const{spinnerSize:a,className:r}=e;return(u.default.createElement(i.default,{className:r},u.default.createElement(u.default.Suspense,{fallback:u.default.createElement(n.default,{delay:100},u.default.createElement(d.default,{size:a}))},u.default.createElement(h,f({},e,{ref:t})))))})));t.default=p},2138:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=s(a(1903)),r=s(a(189)),l=s(a(0)),o=s(a(2)),u=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(82)),i=s(a(347));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function s(e){return e&&e.__esModule?e:{default:e}}function c(){return(c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const f=l.default.forwardRef((function(e,t){const{telemetryName:a,onActivate:n,onContextMenu:o,attachment:u,videoInfo:d,threadKey:s,className:c,playOnHover:f}=e,m=(0,r.default)({url:u.playableUrlInfo,mediaType:"video",mimeType:u.playableUrlMimeType});return m?l.default.createElement(i.default,{className:c,telemetryName:a,onActivate:n,onContextMenu:o,attachment:u,videoInfo:d,threadKey:s,sourceUrl:m,inThread:!1,playOnHover:f,ref:t}):null}));var m=l.default.memo(l.default.forwardRef((function(e,t){const{className:a}=e;return(l.default.createElement(o.default,{className:a},l.default.createElement(l.default.Suspense,{fallback:l.default.createElement(n.default,{delay:100},l.default.createElement(u.default,{size:u.SpinnerSize.Large}))},l.default.createElement(f,c({},e,{ref:t})))))})));t.default=m},2139:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function({onClose:e}){const t=l.default._("Go back",null,{hk:"47dDwb"}).toString();return(o.default.createElement(r.default,{icon:u.default,title:l.default._("Something went wrong while loading this media",null,{hk:"4atz0U"}),ctaPadding:10,cta:o.default.createElement(n.default,{use:n.RectangleButtonUse.Primary,onClick:e,size:n.RectangleButtonSize.Jumbo,"aria-label":t,telemetryName:"mediaViewerErrorFallback",caption:t})}))};var n=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(16)),r=i(a(255)),l=i(a(5)),o=i(a(0)),u=i(a(119));function i(e){return e&&e.__esModule?e:{default:e}}function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}},2140:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=u(a(2141)),r=u(a(1)),l=u(a(0)),o=u(a(2));function u(e){return e&&e.__esModule?e:{default:e}}const i=(0,r.default)(o.default)(e=>({height:84})),d=(0,r.default)(o.default)(e=>({maxWidth:"none",padding:"8px 0px",flexDirection:"row",position:"absolute",left:"50%",transform:`translateX(calc(-42px - ${84*e.selectedIndex}px))`,willChange:"transform",transition:"transform 100ms linear"}));var s=l.default.memo((function(e){const{orderedAttachments:t,selectedIndex:a,onOpenAttachment:r}=e,o=Math.max(0,a-5),u=Math.min(t.length-1,a+5);return l.default.createElement(i,null,l.default.createElement(d,{selectedIndex:a},l.default.createElement("div",{style:{width:84*o}}),t.slice(o,u+1).map((e,t)=>l.default.createElement(n.default,{key:e.attachmentFbid,thumbnailIndex:t+o,attachment:e,onOpenAttachment:r,isSelected:t+o===a})),l.default.createElement("div",{style:{width:84*(t.length-1-u)}})))}));t.default=s},2141:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{attachment:t,isSelected:a,onOpenAttachment:n,thumbnailIndex:r}=e,u=(0,i.useCallback)(()=>{n(r)},[n,r]),d=t.attachmentType,s=(0,l.default)(t.previewUrlInfo);return i.default.createElement(c,{isCurrentAttachment:a,"data-index":r},i.default.createElement(f,{src:s,telemetryName:"mediaViewThumbnailImage",onActivate:u,showPlayIcon:d===o.AttachmentType.Video}))};var n=s(a(2)),r=s(a(637)),l=s(a(27)),o=a(8),u=s(a(1)),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=d();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0));function d(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return d=function(){return e},e}function s(e){return e&&e.__esModule?e:{default:e}}const c=(0,u.default)(n.default)(e=>({img:{width:"100%",height:"100%",objectFit:"cover",borderRadius:"4px",border:e.theme.select({light:"1px solid "+e.theme.colors.base20,dark:"1px solid "+e.theme.colors.flatBase30}),filter:e.isCurrentAttachment?void 0:"brightness(0.3)"},height:68,width:68,margin:"0px 8px",transition:"opacity 100ms ease-in"})),f=(0,u.default)(r.default)(e=>({height:68}))},2142:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.equalToOne=o,t.default=function(){const[e,t]=(0,r.useState)({x:0,y:0}),[a,u]=(0,r.useState)(1),[i,d]=(0,r.useState)("grab"),s=(0,r.useRef)(!1),c=(0,r.useRef)({x:0,y:0}),f=(0,r.useRef)(e),m=(0,r.useRef)({x:0,y:0}),h=(0,r.useCallback)(e=>{t(function(e,t){const a=e.x<0?l(t.x,e.x-50,50-e.x):0,n=e.y<0?l(t.y,e.y-50,50-e.y):0;return{x:a,y:n}}(c.current,e))},[t]),p=(0,r.useCallback)((0,n.throttle)(e=>{if(!s.current)return;const t=e.clientX-m.current.x,a=e.clientY-m.current.y,n={x:f.current.x+t,y:f.current.y+a};h(n)},30),[h]),g=(0,r.useCallback)(e=>{d("grab"),s.current=!1,e.stopPropagation(),window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",g)},[p]),w=(0,r.useCallback)(()=>{u(1),h({x:0,y:0})},[u,h]),y=e=>{let t=.9;o(a)?t=e?.1:.3:a<1?t=.1:a<3?t=.3:a<5&&(t=.6),u(e?a-t:a+t)};return{translate:e,zoom:a,zoomIn:()=>{y(!1)},zoomOut:()=>{y(!0)},zoomToOriginalSize:w,handleMouseDown:t=>{const a=t.currentTarget.children[0];if(null==a)return;s.current=!0;const n=a.getBoundingClientRect();f.current=e,c.current={x:(t.currentTarget.offsetWidth-n.width)/2,y:(t.currentTarget.offsetHeight-n.height)/2},m.current={x:t.clientX,y:t.clientY},d("grabbing"),window.addEventListener("mousemove",p),window.addEventListener("mouseup",g)},handleMouseWheel:t=>{if(t.ctrlKey){const e=-.01*t.deltaY;u(l(a+e,.19,9))}else{const a=t.currentTarget.children[0];if(null==a)return;const n=a.getBoundingClientRect();c.current={x:(t.currentTarget.offsetWidth-n.width)/2,y:(t.currentTarget.offsetHeight-n.height)/2};const r={x:e.x-t.deltaX,y:e.y-t.deltaY};h(r)}},cursor:i}},t.MAX_ZOOM=t.MIN_ZOOM=void 0;var n=a(117),r=a(0);t.MIN_ZOOM=.19;t.MAX_ZOOM=9;function l(e,t,a){return Math.min(a,Math.max(t,e))}function o(e){return Math.abs(e-1)<.001}},2143:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 36 36",height:e.height?e.height:e.size,width:e.width?e.width:e.size,color:e.color},r.default.createElement("path",{fill:"currentColor",d:"M9 9a2 2 0 00-2 2v.5a.5.5 0 00.5.5h18a.5.5 0 01.5.5v14a.5.5 0 00.5.5h.5a2 2 0 002-2V11a2 2 0 00-2-2H9z"}),r.default.createElement("path",{fill:"currentColor",d:"M23.5 27a.5.5 0 00.5-.5v-12a.5.5 0 00-.5-.5h-2a.5.5 0 00-.5.5v12a.5.5 0 00.5.5h2zM18.5 27a.5.5 0 00.5-.5v-12a.5.5 0 00-.5-.5h-11a.5.5 0 00-.5.5V25a2 2 0 002 2h9.5z"}))};var n,r=(n=a(0))&&n.__esModule?n:{default:n}},2144:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"2 2 20 20",height:e.height?e.height:e.size,width:e.width?e.width:e.size,color:e.color},r.default.createElement("g",{id:"ZoomInIcon__zoom-in",fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},r.default.createElement("path",{id:"ZoomInIcon__Group",fill:"currentColor",d:"M12.675 10.675h-2v2a.375.375 0 11-.75 0v-2h-2a.375.375 0 110-.75h2v-2a.375.375 0 11.75 0v2h2a.375.375 0 110 .75zM10.383 6.7a3.683 3.683 0 100 7.367 3.683 3.683 0 000-7.367zm5.66 10.942l-2.184-2.526a.568.568 0 00-.725-.11 5.336 5.336 0 01-2.751.762 5.384 5.384 0 115.382-5.384c0 1.006-.28 1.946-.76 2.751a.563.563 0 00.113.715l2.522 2.191-1.597 1.6zm1.597-1.601c.497.431.524 1.194.06 1.66a1.13 1.13 0 01-1.657-.06l1.597-1.6z"})))};var n,r=(n=a(0))&&n.__esModule?n:{default:n}},2145:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"2 2 20 20",height:e.height?e.height:e.size,width:e.width?e.width:e.size,color:e.color},r.default.createElement("g",{id:"ZoomOutIcon__zoom-out",fill:"none",fillRule:"evenodd",stroke:"none",strokeWidth:"1"},r.default.createElement("path",{id:"ZoomOutIcon__Group",fill:"currentColor",d:"M8.3 9.8h4a.5.5 0 110 1h-4a.5.5 0 110-1zm2.083-3.1a3.683 3.683 0 100 7.367 3.683 3.683 0 000-7.367zm5.66 10.942l-2.184-2.526a.568.568 0 00-.725-.11 5.336 5.336 0 01-2.751.762 5.384 5.384 0 115.382-5.384c0 1.006-.28 1.946-.76 2.751a.563.563 0 00.113.715l2.522 2.191-1.597 1.6zm1.597-1.601c.497.431.524 1.194.06 1.66a1.13 1.13 0 01-1.657-.06l1.597-1.6z"})))};var n,r=(n=a(0))&&n.__esModule?n:{default:n}},2146:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(241),r=O(a(2147)),l=O(a(2148)),o=a(1922),u=a(8),i=O(a(5)),d=a(28),s=a(139),c=a(23),f=O(a(1)),m=O(a(344)),h=O(a(50)),p=a(11),g=O(a(367)),w=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=S();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),y=O(a(2)),b=a(22),M=a(66),v=O(a(33)),x=a(599),E=a(6),C=O(a(4));function S(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return S=function(){return e},e}function O(e){return e&&e.__esModule?e:{default:e}}const _=(0,f.default)(y.default)({alignItems:"center",flex:1,paddingTop:8,paddingLeft:38}),I=(0,f.default)(y.default)({fontSize:0,width:"100%",height:"100%",paddingLeft:8,paddingRight:8,paddingBottom:90}),k=i.default._("Photos & Videos",null,{hk:"tX4xN"}).toString(),P=i.default._("Files",null,{hk:"2DheH2"}).toString();const j={downloadContent:c.InboxActions.messages.downloadContent,showModal:d.AppContextActions.showModal,openMediaViewer:c.InboxActions.mediaViewer.openMediaViewer,closeMediaViewer:c.InboxActions.mediaViewer.closeMediaViewer,loadMoreAttachments:c.InboxActions.mediaViewer.loadMoreAttachments};var D=(0,p.connect)((function(e,{threadKey:t}){const a=(0,c.getMediaViewerInfo)(e,t);if(!a)throw new Error("GalleryView was opened, but no mediaViewerInfo was found in the state");return{media:(0,c.getThreadMedia)(e,t),files:(0,c.getThreadFiles)(e,t),mediaViewerInfo:a,showDownloadDialog:(0,s.isGatekeeperEnabled)(e,"worchon_show_download_dialog")}}),j)((function({threadKey:e,media:t,files:a,downloadContent:d,showModal:s,openMediaViewer:c,closeMediaViewer:f,loadMoreAttachments:p,mediaViewerInfo:y,showDownloadDialog:S}){const O=(0,E.useTheme)(),{showContextMenu:j}=(0,M.useContextMenu)(),D=(0,w.useRef)(-1),R=(0,w.useCallback)(t=>{c(e,t)},[e,c]),A=(0,w.useCallback)((e,t)=>{j({items:(0,x.getMediaContextMenu)(t,d,s,S),target:e})},[d,s,j,S]),z=(0,w.useCallback)(()=>{p(e,u.AttachmentMediaGroup.PhotosAndVideos)},[p,e]),T=(0,w.useCallback)(()=>{p(e,u.AttachmentMediaGroup.FilesOnly)},[p,e]),V=t.length,N=a.length,[F,B]=(0,w.useState)(V>0?"media":N>0?"files":"media");return w.default.createElement(w.default.Fragment,null,w.default.createElement(n.ControlsContainer,{height:42},w.default.createElement(_,null,w.default.createElement(C.default,{use:"body-semibold"},i.default._("Media & Files",null,{hk:"Ygjoe"}).toString())),w.default.createElement(n.MediaViewerButtons,{telemetryName:"closeGalleryView","aria-label":i.default._("Close",null,{hk:"2MCS61"}).toString(),size:b.RoundButtonSize.Small,icon:h.default,buttonColor:O.colors.base30,iconColor:O.semanticColors.textPrimary,onClick:()=>f(e)})),w.default.createElement(n.AttachmentSelector,null,w.default.createElement(m.default,{options:[{name:k,key:"media",ariaLabel:k},{name:P,key:"files",ariaLabel:P}],selectedOptionKey:F,telemetryName:"attachmentFilter",onSelectionChange:e=>B(e)})),"files"===F&&w.default.createElement(w.default.Fragment,null,0===N?w.default.createElement(n.ContentContainer,null,w.default.createElement(C.default,{use:"title"},i.default._("No shared files yet.",null,{hk:"250KxS"}))):w.default.createElement(I,null,w.default.createElement(g.default,null,({width:e,height:t})=>w.default.createElement(r.default,{files:a,loadMoreFiles:T,width:e,height:t})))),"media"===F&&w.default.createElement(w.default.Fragment,null,0===V?w.default.createElement(n.ContentContainer,null,w.default.createElement(C.default,{use:"title"},i.default._("No shared photos or videos yet.",null,{hk:"2iLs9j"}))):w.default.createElement(I,null,w.default.createElement(o.GalleryContextProvider,{onActivate:R,onContextMenu:A,latestRowRendered:D,threadKey:e},w.default.createElement(v.default,{css:{flex:1}},w.default.createElement(g.default,null,({height:e,width:a})=>w.default.createElement(l.default,{attachments:t,openToIndex:null==y?void 0:y.openGalleryToIndex,loadMoreAttachments:z,height:e,width:a})))))))}));t.default=D},2147:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ViewOriginalButton=A,t.default=void 0;var n=a(39),r=E(a(5)),l=a(28),o=a(259),u=a(23),i=E(a(1)),d=a(6),s=E(a(600)),c=E(a(621)),f=a(197),m=a(11),h=x(a(0)),p=E(a(2)),g=x(a(22)),w=a(241),y=a(40),b=a(365),M=E(a(4));function v(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return v=function(){return e},e}function x(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=v();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}return a.default=e,t&&t.set(e,a),a}function E(e){return e&&e.__esModule?e:{default:e}}const C=(0,i.default)(p.default)({flexDirection:"row",justifyContent:"center"}),S=(0,i.default)(p.default)(e=>({height:60,flexDirection:"row",alignItems:"center",padding:6,marginBottom:12,width:"100%",...(0,y.getBorderRadiusStyles)(!1,!0,!0),backgroundColor:e.theme.select({dark:e.theme.colors.flatBase50,light:e.theme.colors.flatBase20}),[`@media (min-width: ${w.CONTAINER_MINIMUM_WIDTH}px)`]:{width:"75%"},[`@media (min-width: ${w.CONTAINER_MEDIUM_WIDTH}px)`]:{width:"50%"}})),O=(0,i.default)(p.default)({flexDirection:"row"}),_=(0,i.default)(M.default)(e=>({color:e.theme.semanticColors.textSecondary,marginLeft:"0.3em",":before":{content:'"• "'}})),I=(0,i.default)(p.default)({flexDirection:"column",marginLeft:"0.3em"}),k=(0,i.default)(I)({flexGrow:0,padding:6}),P=(0,i.default)(I)({flexGrow:10}),j=(0,i.default)(g.default)({marginRight:6}),D=(0,i.default)(I)({flexGrow:1,flexDirection:"row",justifyContent:"right",alignItems:"flex-end",marginLeft:12,padding:6,paddingRight:0}),R=(0,i.default)(p.default)(e=>({width:24,height:24,boxSizing:"content-box",marginRight:12}));function A({file:e,selectMessageSearchResult:t,closeMediaViewer:a}){const n=(0,d.useTheme)(),l=(0,h.useCallback)(()=>{t(e.messageId,e.threadKey),a(e.threadKey)},[e,t,a]);return h.default.createElement(R,null,h.default.createElement(g.default,{"aria-label":r.default._("View original message",null,{hk:"29PMaZ"}).toString(),size:g.RoundButtonSize.Small,telemetryName:"viewOriginal",buttonColor:n.select({dark:n.colors.base50,light:n.colors.base10}),icon:c.default,iconColor:n.semanticColors.textPrimary,iconSize:20,onClick:l}))}function z({file:e,style:t,requestDownload:a,cancelDownload:l,showModal:u,closeMediaViewer:i,selectMessageSearchResult:d}){const c=(0,h.useCallback)(t=>(0,o.getDownloadState)(t,e.attachmentFbid),[e.attachmentFbid]),f=(0,h.useCallback)(t=>(0,o.getDownloadStatus)(t,e.attachmentFbid),[e.attachmentFbid]),p=(0,m.useSelector)(c),w=(0,m.useSelector)(f),y=r.default._("Forward",null,{hk:"28JOka"}).toString();return h.default.createElement(C,{style:t},h.default.createElement(S,null,h.default.createElement(k,null,h.default.createElement(b.FileMessageIcon,{attachment:e})),h.default.createElement(P,null,h.default.createElement(M.default,{use:"body-semibold",numberOfLines:1},e.filename),h.default.createElement(O,null,h.default.createElement(b.FileSizeLabel,{fileSize:e.filesize}),h.default.createElement(_,null,(0,n.getFormattedDatetime)(new Date(e.timestampMs),window.lang)))),h.default.createElement(D,null,h.default.createElement(A,{file:e,closeMediaViewer:i,selectMessageSearchResult:d}),h.default.createElement(j,{telemetryName:"forwardButton",size:g.RoundButtonSize.Small,"aria-label":y,title:y,icon:s.default,iconSize:12,onClick:()=>u({type:"Forward",forwardViewInfo:{attachment:e}},null)}),h.default.createElement(b.RestartButton,{attachment:e,downloadStatus:w,requestDownload:a}),h.default.createElement(b.DownloadStatusIndicator,{attachment:e,download:p,downloadStatus:w,requestDownload:a,cancelDownload:l}))))}const T={requestDownload:f.DownloadsActions.requestDownload,cancelDownload:f.DownloadsActions.cancelDownload,showModal:l.AppContextActions.showModal,closeMediaViewer:u.InboxActions.mediaViewer.closeMediaViewer,selectMessageSearchResult:u.InboxActions.messageSearch.selectMessageSearchResult};var V=(0,m.connect)(null,T)((function({files:e,loadMoreFiles:t,requestDownload:a,cancelDownload:n,width:r,height:l,showModal:o,closeMediaViewer:u,selectMessageSearchResult:i}){const d=(0,h.useCallback)(({visibleStopIndex:a})=>{a===e.length-1&&t()},[e.length,t]);return(h.default.createElement(w.MinimalScrollBarList,{width:r,height:l,itemCount:e.length,itemData:e,itemSize:72,overscanCount:5,onItemsRendered:d},({data:e,index:t,style:r})=>h.default.createElement(z,{style:r,key:e[t].key,file:e[t],requestDownload:a,cancelDownload:n,showModal:o,closeMediaViewer:u,selectMessageSearchResult:i})))}));t.default=V},2148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){const{window:t}=(0,o.useWindowContext)(),{attachments:a,height:n,width:i,loadMoreAttachments:d,openToIndex:s}=e,c=(0,u.useRef)(),f=(0,u.useMemo)(()=>(0,r.itemsPerRow)(i),[i]),m=(0,u.useMemo)(()=>{const e=[];for(let t=0;t<a.length;t+=f)e.push({key:a[t].attachmentFbid,attachments:a.slice(t,t+f)});return e},[a,f]),h=m.length,p=(0,u.useCallback)(({visibleStopIndex:e})=>{e===h-1&&d()},[h,d]);return(0,u.useLayoutEffect)(()=>{var e;s&&(null===(e=c.current)||void 0===e||e.scrollToItem(Math.ceil(s/f)))},[]),u.default.createElement(r.MinimalScrollBarList,{ref:c,width:i,height:n,itemData:m,itemCount:h,itemSize:t.innerWidth/f,overscanCount:2,onItemsRendered:p},l.default)};var n,r=a(241),l=(n=a(2149))&&n.__esModule?n:{default:n},o=a(35),u=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0));function i(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return i=function(){return e},e}},2149:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=o(a(2150)),r=a(1922),l=o(a(0));function o(e){return e&&e.__esModule?e:{default:e}}var u=l.default.memo((function(e){const{data:t,index:a,style:o}=e,{key:u,attachments:i}=t[a],{latestRowRendered:d}=(0,r.useGalleryContext)();return d.current<a&&(d.current=a),l.default.createElement("div",{key:u,style:o},i.map((e,t)=>l.default.createElement(n.default,{key:e.attachmentFbid,attachment:e,index:t})))}));t.default=u},2150:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(241),r=p(a(2151)),l=a(1922),o=p(a(27)),u=a(8),i=p(a(5)),d=a(170),s=p(a(1)),c=p(a(2)),f=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var a={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var l=n?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(a,r,l):a[r]=e[r]}a.default=e,t&&t.set(e,a);return a}(a(0)),m=p(a(4));function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function p(e){return e&&e.__esModule?e:{default:e}}const g={playTime:0,playState:d.PlayStates.Paused,target:d.Targets.Fullscreen,volume:1,isMuted:!0},w=s.default.div({display:"inline-block",position:"relative",width:"calc(100% / 7)","@media (max-width: 1200px)":{width:"calc(100% / 5)"},"@media (max-width: 600px)":{width:"calc(100% / 3)"},":after":{paddingBottom:"100%",display:"block",content:'""'},"img, video":{objectFit:"cover",objectPosition:"center",height:"100%",width:"100%"}}),y=(0,s.default)(r.default)(e=>({...(0,n.GalleryMediaStyles)(e.theme),height:"auto"})),b=(0,s.default)(c.default)(e=>({...(0,n.GalleryMediaStyles)(e.theme),textAlign:"center",alignItems:"center",justifyContent:"center",flex:1}));var M=f.default.memo((function(e){const{attachment:t,index:a}=e,{onActivate:r,onContextMenu:d,threadKey:s}=(0,l.useGalleryContext)(),c=(0,f.useCallback)(()=>{t&&r(t)},[t,r]),h=(0,f.useCallback)(e=>{t&&d(e,t)},[t,d]);if(!t)return null;let p;switch(t.attachmentType){case u.AttachmentType.Image:p=f.default.createElement(n.ImageView,{src:(0,o.default)(t.previewUrlInfo),telemetryName:"mediaGalleryImage",onActivate:c,"aria-label":i.default._("Photo",null,{hk:"3pK9wd"}),onContextMenu:h,index:a,opacity:1});break;case u.AttachmentType.Video:p=f.default.createElement(y,{attachment:t,telemetryName:"mediaGalleryVideo","aria-label":i.default._("Video",null,{hk:"RwUdG"}),onActivate:c,onContextMenu:h,playOnHover:!0,index:a,enableVideoPlayer:!1,videoInfo:g,threadKey:s});break;default:p=f.default.createElement(b,null,f.default.createElement(m.default,{use:"caption",numberOfLines:2},i.default._("Unsupported media format",null,{hk:"2x9ogJ"}).toString()))}return(f.default.createElement(w,null,f.default.createElement(n.ThumbnailContainer,null,p)))}));t.default=M},2151:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(100),r=u(a(189)),l=u(a(0)),o=u(a(347));function u(e){return e&&e.__esModule?e:{default:e}}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}const d=l.default.forwardRef((function({telemetryName:e,onActivate:t,onContextMenu:a,attachment:n,videoInfo:u,threadKey:i,className:d,playOnHover:s,enableVideoPlayer:c=!0},f){const m=(0,r.default)({url:n.playableUrlInfo,mediaType:"video",mimeType:n.playableUrlMimeType});return m?l.default.createElement(o.default,{className:d,telemetryName:e,onActivate:t,onContextMenu:a,attachment:n,videoInfo:u,threadKey:i,sourceUrl:m,inThread:!1,playOnHover:s,ref:f,enableVideoPlayer:c}):null}));var s=l.default.memo(l.default.forwardRef((function(e,t){const{index:a}=e;return(l.default.createElement(l.default.Suspense,{fallback:l.default.createElement(n.RectangleShimmer,{index:a})},l.default.createElement(d,i({},e,{ref:t}))))})));t.default=s}}]);
//# sourceMappingURL=https://intern.facebook.com/intern/messenger/desktop/sourcemaps?archon_build_number=332019425&map_path=../sourcemaps/MediaViewer.bundle.js.map